(this["webpackJsonpml-react"]=this["webpackJsonpml-react"]||[]).push([[0],{185:function(e,t,a){e.exports=a(376)},190:function(e,t,a){},376:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),l=a(63),c=a.n(l),i=(a(190),a(50)),u=a(96),o=(a(191),a(68)),s=a(69),m=a(71),d=a(8),E=a.n(d),p=a(47),f=a.n(p),b=a(12),v=a(21);function h(){var e=Object(u.a)(["\nquery GetPredictions ( $version: Int!, $was_back_predicted: [Boolean!] ) {\n    predictions ( where: { prediction: { _is_null: false }, actual: { _is_null: false }, _version: { _eq: $version }, was_back_predicted: { _in: $was_back_predicted }}) {\n        actual id time\n        instrument\n        prediction\n        _version\n    }\n}"]);return h=function(){return e},e}function g(){var e=Object(u.a)(["\nquery GetVersions {\n    versions { id }\n}\n"]);return g=function(){return e},e}var y=f()(g()),j=f()(h());function k(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(-1),u=Object(i.a)(c,2),d=u[0],p=u[1],f=Object(n.useState)(!0),b=Object(i.a)(f,2),h=b[0],g=b[1],k=Object(o.b)(y).data,B=Object(o.a)(j),w=Object(i.a)(B,2),F=w[0],_=w[1],z=_.data,S=_.loading;Object(n.useEffect)((function(){return F({variables:{version:d,was_back_predicted:h?[!0,!1]:[!1]}})}),[d,h]);var C=E.a.get(z,"predictions"),D=E.a.map(E.a.get(k,"versions"),"id");Object(n.useEffect)((function(){-1!==d||E.a.isEmpty(D)||p(Object(v.max)(D))}),[D]);var q=E.a.uniq(E.a.map(C,"instrument"));Object(n.useEffect)((function(){a||l(E.a.first(q))}),[q]);var M=E.a.filter(C,["instrument",a]);return r.a.createElement("div",{className:"body"},r.a.createElement("div",{className:"header"},r.a.createElement("h1",null,"Visualisation and Stats analysis of my ML model"),r.a.createElement("p",null,"All predictions pulled for my model, visualised and analysed.")),r.a.createElement("div",{className:"options"},r.a.createElement("div",null,r.a.createElement("p",null,"Select Version:"),r.a.createElement("select",{value:d,onChange:function(e){return p(e.target.value)}},!E.a.isEmpty(D)&&E.a.map(D,(function(e){return r.a.createElement("option",{key:e,value:e},e)})))),r.a.createElement("div",null,r.a.createElement("p",null,"Select Instruments:"),r.a.createElement("select",{value:a,onChange:function(e){return l(e.target.value)}},!E.a.isEmpty(q)&&E.a.map(q,(function(e){return r.a.createElement("option",{key:e,value:e},e)})))),r.a.createElement("div",{onClick:function(){return g(!h)}},r.a.createElement("p",null,"Include back-predicted results"),h?r.a.createElement(s.a,{icon:m.a}):r.a.createElement(s.a,{icon:m.c,className:"unchecked"}))),S||!d?r.a.createElement("div",{className:"loader"},r.a.createElement(s.a,{icon:m.b,spin:!0,size:"3x"})):r.a.createElement(r.a.Fragment,null,E.a.isEmpty(M)?r.a.createElement("p",null,"Nothing to display - change a filter!"):r.a.createElement("div",{className:"chart"},r.a.createElement("hr",null),r.a.createElement("div",{className:"stats"},r.a.createElement(N,{data:M})),r.a.createElement("hr",null),r.a.createElement("div",{className:"scatter"},r.a.createElement(O,{data:M})),r.a.createElement("hr",null),r.a.createElement("div",{className:"distribution"},r.a.createElement(x,{data:M})))))}var O=Object(n.memo)((function(e){var t=e.data,a=E.a.map(t,(function(e){var t=e.actual,a=e.prediction;return{actual:Number((100*t).toFixed(4)),prediction:Number((100*a).toFixed(4))}})),n=E.a.map(t,(function(e){return[100*e.actual,100*e.prediction]})),l=E.a.reduce(a,(function(e,t){var a=Math.abs(E.a.get(t,"actual")),n=Math.abs(E.a.get(t,"prediction"));return a>n?a>e?a:e:n>e?n:e}),-1/0),c=[-1*Math.ceil(2*l)/2,1*Math.ceil(2*l)/2],i=Object(v.linearRegressionLine)(Object(v.linearRegression)(n)),u=[{actual:c[0],prediction:i(c[0])},{actual:c[1],prediction:i(c[1])}],o=Object(v.standardDeviation)(E.a.map(a,"actual")),s=-1*o;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Predictions vs Actuals scatter"),r.a.createElement(b.e,null,r.a.createElement(b.g,{margin:{top:20,bottom:20},data:a},r.a.createElement(b.a,null),r.a.createElement(b.i,{type:"number",dataKey:"actual",name:"actual",domain:c,label:{value:"Actual Change (cents)",position:"bottom",offset:0}}),r.a.createElement(b.j,{type:"number",dataKey:"prediction",name:"prediction",domain:c,label:{value:"Predicted Change (cents)",position:"centerBottom",angle:-90,offset:5}}),r.a.createElement(b.h,{cursor:{strokeDasharray:"3 3"}}),r.a.createElement(b.f,{data:a,fill:"#82ca9d",shape:"triangle"}),r.a.createElement(b.f,{line:{stroke:"#e16162",strokeWidth:1},data:u,shape:"circle",fill:"#e16162"}),r.a.createElement(b.d,{x:o,stroke:"#C98BBE",strokeDasharray:"3 6",label:{value:"+ \u03c3",position:"insideBottomRight"}}),r.a.createElement(b.d,{x:s,stroke:"#C98BBE",strokeDasharray:"3 6",label:{value:"- \u03c3",position:"insideBottomRight"}}),r.a.createElement(b.d,{y:o,stroke:"#C98BBE",strokeDasharray:"3 6",label:{value:"+ \u03c3",position:"insideTopLeft"}}),r.a.createElement(b.d,{y:s,stroke:"#C98BBE",strokeDasharray:"3 6",label:{value:"- \u03c3",position:"insideTopLeft"}}))))}),E.a.isEqual),x=Object(n.memo)((function(e){var t=e.data,a=E.a.map(t,(function(e){var t=e.actual,a=e.prediction;return Number(100*(t-a).toFixed(4))})),n=2*Object(v.max)([0-Object(v.min)(a),Object(v.max)(a)]),l=n/20,c=n/2*-1,i=E.a.map(E.a.range(0,21),(function(e){var t=Number((c+l*(e-.5)).toFixed(5)),n=Number((c+l*e).toFixed(5)),r=Number((c+l*(e+.5)).toFixed(5)),i=E.a.filter(a,(function(e){return e>t&&e<=r}));return{name:n,value:E.a.size(i)}}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Variations distribution"),r.a.createElement(b.e,null,r.a.createElement(b.b,{data:i,margin:{top:20,bottom:20,left:-25}},r.a.createElement(b.i,{dataKey:"name"}),r.a.createElement(b.j,{dataKey:"value"}),r.a.createElement(b.h,null),r.a.createElement(b.c,{type:"natural",dataKey:"value",stroke:"#82ca9d",dot:!1}),r.a.createElement(b.d,{x:0,stroke:"#C98BBE",label:{value:"0",position:"insideBottomRight"}}))))}),E.a.isEqual),N=function(e){var t=e.data,a=E.a.size(t),n=Object(v.standardDeviation)(E.a.map(t,"actual")),l=-1*n,c=E.a.filter(t,(function(e){return e.actual>n})),i=E.a.filter(t,(function(e){return e.actual<l})),u=E.a.filter(t,(function(e){var t=e.actual;return t>=l&&t<=n})),o=E.a.filter(c,(function(e){return e.prediction>n})),s=E.a.filter(i,(function(e){return e.prediction<n})),m=E.a.filter(u,(function(e){var t=e.prediction;return t>=l&&t<=n})),d=E.a.size(o)/E.a.size(c)*100,p=E.a.size(s)/E.a.size(i)*100,f=E.a.size(m)/E.a.size(u)*100,b=E.a.map(t,(function(e){var t=e.actual,a=e.prediction;return Number((t-a).toFixed(4))})),h=Object(v.mean)(b),g=Object(v.standardDeviation)(b);return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Basic Stats"),r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Number of Samples:"),r.a.createElement("td",null,a)),r.a.createElement("tr",null,r.a.createElement("td",null,"Sample mean:"),r.a.createElement("td",null,100*h.toFixed(5))),r.a.createElement("tr",null,r.a.createElement("td",null,"Sample Standard Deviation (have not checked if curve is normal..):"),r.a.createElement("td",null,100*g.toFixed(5))),r.a.createElement("tr",null,r.a.createElement("td",null,"Percentage of samples which predicted up and were correct:"),r.a.createElement("td",null,E.a.size(o)," / ",E.a.size(c)," = ",d.toFixed(1),"%")),r.a.createElement("tr",null,r.a.createElement("td",null,"Percentage of samples which predicted downward and were correct:"),r.a.createElement("td",null,E.a.size(s)," / ",E.a.size(i)," = ",p.toFixed(1),"%")),r.a.createElement("tr",null,r.a.createElement("td",null,"Percentage of samples which predicted flat and were correct:"),r.a.createElement("td",null,E.a.size(m)," / ",E.a.size(u)," = ",f.toFixed(1),"%")))))},B=a(17),w=a(162);function F(){var e=new w.a({uri:"https://boiling-ridge-24261.herokuapp.com/v1/graphql"});return r.a.createElement(B.a,{client:e},r.a.createElement(k,null))}c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(F,null)),document.getElementById("root"))}},[[185,1,2]]]);
//# sourceMappingURL=main.0ed82c30.chunk.js.map