(this["webpackJsonpml-react"]=this["webpackJsonpml-react"]||[]).push([[0],{185:function(e,a,t){e.exports=t(375)},190:function(e,a,t){},375:function(e,a,t){"use strict";t.r(a);var n=t(1),r=t.n(n),l=t(61),c=t.n(l),i=(t(190),t(68)),o=t(93),u=t(94),s=t.n(u),m=t(66),d=t(148),p=t(162),E=t(11),f=t.n(E),v=t(46),b=t.n(v),g=t(15),h=t(98);function y(){var e=Object(o.a)(["\nquery GetPredictions ( $version: Int! ) {\n    predictions ( where: { prediction: { _is_null: false }, actual: { _is_null: false }, _version: { _eq: $version }}) {\n        actual id time\n        instrument\n        prediction\n        _version\n    }\n}"]);return y=function(){return e},e}function j(){var e=Object(o.a)(["\nquery GetVersions {\n    versions { id }\n}\n"]);return j=function(){return e},e}var O=b()(j()),k=b()(y());function _(){var e=Object(n.useState)(!1),a=Object(i.a)(e,2),t=a[0],l=a[1],c=Object(n.useState)(!1),o=Object(i.a)(c,2),u=o[0],s=o[1],E=Object(m.b)(O).data,v=Object(m.a)(k),b=Object(i.a)(v,2),g=b[0],h=b[1],y=h.data,j=h.loading;Object(n.useEffect)((function(){return g({variables:{version:u}})}),[u]);var _=f.a.get(y,"predictions"),N=f.a.filter(_,["_version",u]),S=f.a.map(f.a.get(E,"versions"),"id");Object(n.useEffect)((function(){u||s(Math.max(S))}),[S]);var w=f.a.uniq(f.a.map(N,"instrument"));Object(n.useEffect)((function(){t||l(f.a.first(w))}),[w]);var x=f.a.filter(N,["instrument",t]);return r.a.createElement("div",{className:"body"},r.a.createElement("div",{className:"header"},r.a.createElement("h2",null,"Visualisation and Stats analysis of my ML model"),r.a.createElement("p",null,"All predictions pulled for my model, visualised and analysed.")),r.a.createElement("div",{className:"options"},r.a.createElement("div",null,r.a.createElement("p",null,"Select Version:"),r.a.createElement("select",{value:u,onChange:function(e){return s(e.target.value)}},!f.a.isEmpty(S)&&f.a.map(S,(function(e){return r.a.createElement("option",{key:e,value:e},e)})))),r.a.createElement("div",null,r.a.createElement("p",null,"Select Instruments:"),r.a.createElement("select",{value:t,onChange:function(e){return l(e.target.value)}},!f.a.isEmpty(w)&&f.a.map(w,(function(e){return r.a.createElement("option",{key:e,value:e},e)}))))),j||!u?r.a.createElement("div",{className:"loader"},r.a.createElement(d.a,{icon:p.a,spin:!0,size:"3x"})):r.a.createElement(r.a.Fragment,null,f.a.isEmpty(x)?r.a.createElement("p",null,"Nothing to display - change a filter!"):r.a.createElement("div",{className:"chart"},r.a.createElement("div",{className:"scatter"},r.a.createElement(q,{data:x})))))}var q=Object(n.memo)((function(e){var a=e.data,t=f.a.map(a,(function(e){return{actual:100*e.actual,prediction:100*e.prediction}})),n=f.a.map(a,(function(e){return[100*e.actual,100*e.prediction]})),l=f.a.reduce(t,(function(e,a){var t=Math.abs(f.a.get(a,"actual")),n=Math.abs(f.a.get(a,"prediction"));return t>n?t>e?t:e:n>e?n:e}),-1/0),c=[-1*l.toFixed(2),1*l.toFixed(2)];console.log(c);var i=Object(h.linearRegressionLine)(Object(h.linearRegression)(n)),o=[{actual:c[0],prediction:i(c[0])},{actual:c[1],prediction:i(c[1])}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(g.e,null,r.a.createElement(g.b,{margin:{top:20,bottom:20},data:t},r.a.createElement(g.a,null),r.a.createElement(g.i,{type:"number",dataKey:"actual",name:"actual",domain:c,label:{value:"Actual Change (cents)",position:"bottom",offset:0}}),r.a.createElement(g.j,{type:"number",dataKey:"prediction",name:"prediction",domain:c,label:{value:"Predicted Change (cents)",position:"centerBottom",angle:90,offset:5},orientation:"right"}),r.a.createElement(g.h,{cursor:{strokeDasharray:"3 3"}}),r.a.createElement(g.f,{name:"A school",data:t,fill:"#f9bc60"}),r.a.createElement(g.f,{line:{stroke:"#e16162",strokeWidth:1},data:o}))))}),f.a.isEqual);g.g.proptypes={data:s.a.array},Object(n.memo)((function(e){var a=e.data;f.a.map(a,(function(e){return e.actual-e.prediction}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(g.e,null,r.a.createElement(g.d,{width:500,height:300,data:a,margin:{top:5,right:30,left:20,bottom:5}},r.a.createElement(g.a,{strokeDasharray:"3 3"}),r.a.createElement(g.i,{dataKey:"name"}),r.a.createElement(g.j,null),r.a.createElement(g.h,null),r.a.createElement(g.c,{type:"monotone",dataKey:"uv",stroke:"#82ca9d"}))))}),f.a.isEqual).proptypes={data:s.a.array};var N=t(17),S=t(163);function w(){var e=new S.a({uri:"https://boiling-ridge-24261.herokuapp.com/v1/graphql"});return r.a.createElement(N.a,{client:e},r.a.createElement(_,null))}c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(w,null)),document.getElementById("root"))}},[[185,1,2]]]);
//# sourceMappingURL=main.59cd2217.chunk.js.map