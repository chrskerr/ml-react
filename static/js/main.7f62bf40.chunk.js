(this["webpackJsonpml-react"]=this["webpackJsonpml-react"]||[]).push([[0],{190:function(e,t,a){e.exports=a(380)},195:function(e,t,a){},380:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),l=a(63),i=a.n(l),c=(a(195),a(50)),o=a(96),u=a(68),m=a(69),d=a(71),s=a(3),E=a.n(s),p=a(45),f=a.n(p),b=a(12),v=(a(104),a(8));function h(e){var t=e.data;return r.a.createElement("div",{className:"charts absolute"},r.a.createElement("hr",null),r.a.createElement("div",{className:"stats"},r.a.createElement(x,{data:t})),r.a.createElement("hr",null),r.a.createElement("div",{className:"distribution"},r.a.createElement(k,{data:t})),r.a.createElement("hr",null),r.a.createElement("div",{className:"scatter"},r.a.createElement(y,{data:t})),r.a.createElement("hr",null),r.a.createElement("div",{className:"scatter"},r.a.createElement(g,{data:t})))}function g(e){var t=e.data,a=E.a.map(t,(function(e){var t=e.actual,a=e.prediction;return{actual:Number(t.toFixed(4)),prediction:Number(a.toFixed(4)),z:1}})),n=E.a.map(t,(function(e){return[e.actual,e.prediction]})),l=Object(b.linearRegressionLine)(Object(b.linearRegression)(n)),i=E.a.reduce(a,(function(e,t){var a=E.a.get(t,"actual"),n=E.a.get(t,"prediction");return a>n?a>e?a:e:n>e?n:e}),-1/0),c=[E.a.reduce(a,(function(e,t){var a=E.a.get(t,"actual"),n=E.a.get(t,"prediction");return a<n?a<e?a:e:n<e?n:e}),1/0),i],o=[{actual:c[0],prediction:l(c[0])},{actual:c[1],prediction:l(c[1])}];return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Price distribution scatter"),r.a.createElement(v.c,null,r.a.createElement(v.e,{margin:{top:50,bottom:20,right:70,left:20}},r.a.createElement(v.a,null),r.a.createElement(v.g,{type:"number",dataKey:"actual",name:"actual",domain:c,label:{value:"Actual Change (cents)",position:"bottom",offset:0}}),r.a.createElement(v.h,{type:"number",dataKey:"prediction",name:"prediction",domain:c,label:{value:"Predicted Change (cents)",position:"left",angle:-90,offset:0}}),r.a.createElement(v.i,{dataKey:"z",range:[1,10]}),r.a.createElement(v.f,{cursor:{strokeDasharray:"3 3"}}),r.a.createElement(v.d,{data:a,fill:"#82ca9d",shape:"circle"}),r.a.createElement(v.d,{line:{stroke:"#e16162",strokeWidth:1},data:o,shape:"circle",fill:"#e16162"}))))}function y(e){var t=e.data,a=E.a.map(t,(function(e){var t=e.actual,a=e.prediction,n=e.close;return{actual:Number((t-n).toFixed(4)),prediction:Number((a-n).toFixed(4)),z:1}})),n=E.a.map(a,(function(e){return[e.actual,e.prediction]})),l=Object(b.linearRegressionLine)(Object(b.linearRegression)(n)),i=E.a.reduce(a,(function(e,t){var a=E.a.get(t,"actual"),n=E.a.get(t,"prediction");return a>n?a>e?a:e:n>e?n:e}),-1/0),c=[E.a.reduce(a,(function(e,t){var a=E.a.get(t,"actual"),n=E.a.get(t,"prediction");return a<n?a<e?a:e:n<e?n:e}),1/0),i],o=[{actual:c[0],prediction:l(c[0])},{actual:c[1],prediction:l(c[1])}];return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Prediction difference distribution scatter"),r.a.createElement(v.c,null,r.a.createElement(v.e,{margin:{top:50,bottom:20,right:70,left:20}},r.a.createElement(v.a,null),r.a.createElement(v.g,{type:"number",dataKey:"actual",name:"actual",domain:c,label:{value:"Actual Change (cents)",position:"bottom",offset:0}}),r.a.createElement(v.h,{type:"number",dataKey:"prediction",name:"prediction",domain:c,label:{value:"Predicted Change (cents)",position:"left",angle:-90,offset:0}}),r.a.createElement(v.i,{dataKey:"z",range:[1,10]}),r.a.createElement(v.f,{cursor:{strokeDasharray:"3 3"}}),r.a.createElement(v.d,{data:a,fill:"#82ca9d",shape:"circle"}),r.a.createElement(v.d,{line:{stroke:"#e16162",strokeWidth:1},data:o,shape:"circle",fill:"#e16162"}))))}function k(e){var t=e.data,a=E.a.map(t,(function(e){var t=e.actual,a=e.prediction;return Number((t-a).toFixed(4))})),n=2*Object(b.max)([0-Object(b.min)(a),Object(b.max)(a)]),l=n/50,i=Object(b.mean)(a),c=Object(b.standardDeviation)(a),o=n/2*-1,u=E.a.map(E.a.range(0,51),(function(e){var t=Number((o+l*(e-.5)).toFixed(5)),n=Number((o+l*e).toFixed(5)),r=Number((o+l*(e+.5)).toFixed(5)),i=E.a.filter(a,(function(e){return e>t&&e<=r}));return{name:n,value:E.a.size(i),size:0}})),m=i+c,d=i-c;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Variations distribution"),r.a.createElement(v.c,null,r.a.createElement(v.e,{margin:{top:20,bottom:20,left:-25}},r.a.createElement(v.g,{dataKey:"name"}),r.a.createElement(v.h,{dataKey:"value"}),r.a.createElement(v.i,{dataKey:"size",range:[1,10]}),r.a.createElement(v.f,{cursor:{strokeDasharray:"3 3"}}),r.a.createElement(v.d,{data:u,line:{stroke:"#82ca9d",strokeWidth:1},stroke:"#82ca9d"}),r.a.createElement(v.b,{x:i,stroke:"#C98BBE",label:{value:"Mean",orientation:90,position:"insideBottomRight"}}),r.a.createElement(v.b,{x:m,stroke:"#C98BBE",label:{value:"+ \u03c3",orientation:90,position:"insideBottomRight"}}),r.a.createElement(v.b,{x:d,stroke:"#C98BBE",label:{value:"- \u03c3",orientation:90,position:"insideBottomRight"}}))))}var x=function(e){var t=e.data,a=E.a.size(t),n=E.a.map(t,(function(e){var t=e.actual,a=e.prediction,n=e.close;return{actual:Number((t-n).toFixed(4)),prediction:Number((a-n).toFixed(4))}})),l=Object(b.standardDeviation)(E.a.map(n,"actual")),i=-1*l,c=E.a.filter(n,(function(e){return e.actual>l})),o=E.a.filter(n,(function(e){return e.actual<i})),u=E.a.filter(n,(function(e){var t=e.actual;return t>=i&&t<=l})),m=E.a.filter(c,(function(e){return e.prediction>l})),d=E.a.filter(o,(function(e){return e.prediction<l})),s=E.a.filter(u,(function(e){var t=e.prediction;return t>=i&&t<=l})),p=E.a.size(m)/E.a.size(c)*100,f=E.a.size(d)/E.a.size(o)*100,v=E.a.size(s)/E.a.size(u)*100,h=E.a.map(n,(function(e){var t=e.actual,a=e.prediction;return Number((t-a).toFixed(4))})),g=Object(b.mean)(h),y=Object(b.standardDeviation)(h);return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Basic Stats"),r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Number of Samples:"),r.a.createElement("td",null,a)),r.a.createElement("tr",null,r.a.createElement("td",null,"Sample mean:"),r.a.createElement("td",null,g.toFixed(5))),r.a.createElement("tr",null,r.a.createElement("td",null,"Sample Standard Deviation:"),r.a.createElement("td",null,y.toFixed(5))),r.a.createElement("tr",null,r.a.createElement("td",null,"Percentage of samples which predicted up and were correct:"),r.a.createElement("td",null,E.a.size(m)," / ",E.a.size(c)," = ",p.toFixed(1),"%")),r.a.createElement("tr",null,r.a.createElement("td",null,"Percentage of samples which predicted downward and were correct:"),r.a.createElement("td",null,E.a.size(d)," / ",E.a.size(o)," = ",f.toFixed(1),"%")),r.a.createElement("tr",null,r.a.createElement("td",null,"Percentage of samples which predicted flat and were correct:"),r.a.createElement("td",null,E.a.size(s)," / ",E.a.size(u)," = ",v.toFixed(1),"%")))))};function z(e){var t=e.data;return r.a.createElement("div",{className:"charts change"},r.a.createElement("hr",null),r.a.createElement("div",{className:"stats"},r.a.createElement(F,{data:t})),r.a.createElement("hr",null),r.a.createElement("div",{className:"distribution"},r.a.createElement(O,{data:t})),r.a.createElement("hr",null),r.a.createElement("div",{className:"scatter"},r.a.createElement(j,{data:t})))}function j(e){var t=e.data,a=E.a.map(t,(function(e){var t=e.actual,a=e.prediction;return{actual:Number(100*t.toFixed(4)),prediction:Number(100*a.toFixed(4)),z:1}})),n=E.a.map(a,(function(e){return[e.actual,e.prediction]})),l=Object(b.linearRegressionLine)(Object(b.linearRegression)(n)),i=Object(b.standardDeviation)(E.a.map(a,"actual")),c=-1*i,o=E.a.reduce(a,(function(e,t){var a=Math.abs(E.a.get(t,"actual")),n=Math.abs(E.a.get(t,"prediction"));return a>n?a>e?a:e:n>e?n:e}),-1/0),u=[-1*Math.ceil(2*o)/2,1*Math.ceil(2*o)/2],m=[{actual:u[0],prediction:l(u[0])},{actual:u[1],prediction:l(u[1])}];return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Predictions vs Actuals scatter"),r.a.createElement(v.c,null,r.a.createElement(v.e,{margin:{top:50,bottom:20,right:70,left:20}},r.a.createElement(v.a,null),r.a.createElement(v.g,{type:"number",dataKey:"actual",name:"actual",domain:u,label:{value:"Actual Change (cents)",position:"bottom",offset:0}}),r.a.createElement(v.h,{type:"number",dataKey:"prediction",name:"prediction",domain:u,label:{value:"Predicted Change (cents)",position:"left",angle:-90,offset:0}}),r.a.createElement(v.i,{dataKey:"z",range:[1,10]}),r.a.createElement(v.f,{cursor:{strokeDasharray:"3 3"}}),r.a.createElement(v.d,{data:a,fill:"#82ca9d",shape:"circle"}),r.a.createElement(v.d,{line:{stroke:"#e16162",strokeWidth:1},data:m,shape:"circle",fill:"#e16162"}),r.a.createElement(v.b,{x:i,stroke:"#C98BBE",strokeDasharray:"3 6",label:{value:"+ \u03c3",position:"insideBottomRight"}}),r.a.createElement(v.b,{x:c,stroke:"#C98BBE",strokeDasharray:"3 6",label:{value:"- \u03c3",position:"insideBottomRight"}}),r.a.createElement(v.b,{y:i,stroke:"#C98BBE",strokeDasharray:"3 6",label:{value:"+ \u03c3",position:"insideTopLeft"}}),r.a.createElement(v.b,{y:c,stroke:"#C98BBE",strokeDasharray:"3 6",label:{value:"- \u03c3",position:"insideTopLeft"}}))))}function O(e){var t=e.data,a=E.a.map(t,(function(e){var t=e.actual,a=e.prediction;return Number(100*(t-a).toFixed(4))})),n=2*Object(b.max)([0-Object(b.min)(a),Object(b.max)(a)]),l=n/50,i=Object(b.mean)(a),c=Object(b.standardDeviation)(a),o=n/2*-1,u=E.a.map(E.a.range(0,51),(function(e){var t=Number((o+l*(e-.5)).toFixed(5)),n=Number((o+l*e).toFixed(5)),r=Number((o+l*(e+.5)).toFixed(5)),i=E.a.filter(a,(function(e){return e>t&&e<=r}));return{name:n,value:E.a.size(i),size:0}})),m=i+c,d=i-c;return console.log(d,m),r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Variations distribution"),r.a.createElement(v.c,null,r.a.createElement(v.e,{margin:{top:20,bottom:20,left:-25}},r.a.createElement(v.g,{dataKey:"name"}),r.a.createElement(v.h,{dataKey:"value"}),r.a.createElement(v.i,{dataKey:"size",range:[1,10]}),r.a.createElement(v.f,{cursor:{strokeDasharray:"3 3"}}),r.a.createElement(v.d,{data:u,line:{stroke:"#82ca9d",strokeWidth:1},stroke:"#82ca9d"}),r.a.createElement(v.b,{x:i,stroke:"#C98BBE",label:{value:"Mean",orientation:90,position:"insideBottomRight"}}),r.a.createElement(v.b,{x:m,stroke:"#C98BBE",label:{value:"+ \u03c3",orientation:90,position:"insideBottomRight"}}),r.a.createElement(v.b,{x:d,stroke:"#C98BBE",label:{value:"- \u03c3",orientation:90,position:"insideBottomRight"}}))))}var F=function(e){var t=e.data,a=E.a.size(t),n=Object(b.standardDeviation)(E.a.map(t,"actual")),l=-1*n,i=E.a.filter(t,(function(e){return e.actual>n})),c=E.a.filter(t,(function(e){return e.actual<l})),o=E.a.filter(t,(function(e){var t=e.actual;return t>=l&&t<=n})),u=E.a.filter(i,(function(e){return e.prediction>n})),m=E.a.filter(c,(function(e){return e.prediction<n})),d=E.a.filter(o,(function(e){var t=e.prediction;return t>=l&&t<=n})),s=E.a.size(u)/E.a.size(i)*100,p=E.a.size(m)/E.a.size(c)*100,f=E.a.size(d)/E.a.size(o)*100,v=E.a.map(t,(function(e){var t=e.actual,a=e.prediction;return Number(100*(t-a).toFixed(4))})),h=Object(b.mean)(v),g=Object(b.standardDeviation)(v);return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Basic Stats"),r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Number of Samples:"),r.a.createElement("td",null,a)),r.a.createElement("tr",null,r.a.createElement("td",null,"Sample mean:"),r.a.createElement("td",null,h.toFixed(5))),r.a.createElement("tr",null,r.a.createElement("td",null,"Sample Standard Deviation:"),r.a.createElement("td",null,g.toFixed(5))),r.a.createElement("tr",null,r.a.createElement("td",null,"Percentage of samples which predicted up and were correct:"),r.a.createElement("td",null,E.a.size(u)," / ",E.a.size(i)," = ",s.toFixed(1),"%")),r.a.createElement("tr",null,r.a.createElement("td",null,"Percentage of samples which predicted downward and were correct:"),r.a.createElement("td",null,E.a.size(m)," / ",E.a.size(c)," = ",p.toFixed(1),"%")),r.a.createElement("tr",null,r.a.createElement("td",null,"Percentage of samples which predicted flat and were correct:"),r.a.createElement("td",null,E.a.size(d)," / ",E.a.size(o)," = ",f.toFixed(1),"%")))))};function N(){var e=Object(o.a)(["\nquery GetPredictions ( $version: Int!, $was_back_predicted: [Boolean!] ) {\n    predictions ( where: { \n        prediction: { _is_null: false }, \n        actual: { _is_null: false }, \n        _version: { _eq: $version }, \n        was_back_predicted: { _in: $was_back_predicted }\n    }) {\n        actual id time\n        instrument\n        prediction\n        _version\n        close\n    }\n}"]);return N=function(){return e},e}function B(){var e=Object(o.a)(["\nquery GetVersions {\n    versions { id prediction_type }\n}\n"]);return B=function(){return e},e}var w=f()(B()),C=f()(N());function D(){var e=Object(n.useState)(!1),t=Object(c.a)(e,2),a=t[0],l=t[1],i=Object(n.useState)(-1),o=Object(c.a)(i,2),s=o[0],p=o[1],f=Object(n.useState)(!0),v=Object(c.a)(f,2),g=v[0],y=v[1],k=Object(u.b)(w).data,x=Object(u.a)(C),j=Object(c.a)(x,2),O=j[0],F=j[1],N=F.data,B=F.loading;Object(n.useEffect)((function(){return O({variables:{version:s,was_back_predicted:g?[!0,!1]:[!1]}})}),[s,g]);var D=E.a.get(N,"predictions"),_=E.a.map(E.a.get(k,"versions"),"id");Object(n.useEffect)((function(){-1!==s||E.a.isEmpty(_)||p(Object(b.max)(_))}),[_]);var S=E.a.get(E.a.find(E.a.get(k,"versions"),["id",s]),"prediction_type"),K=E.a.uniq(E.a.map(D,"instrument"));Object(n.useEffect)((function(){return l(E.a.first(K))}),[K,s]);var R=E.a.filter(D,["instrument",a]);return console.log(a,s,S,R),r.a.createElement("div",{className:"body"},r.a.createElement("div",{className:"header"},r.a.createElement("h1",null,"Visualisation and Stats analysis of my ML model"),r.a.createElement("p",null,"All predictions pulled for my model, visualised and analysed.")),r.a.createElement("div",{className:"options"},r.a.createElement("div",null,r.a.createElement("p",null,"Select Version:"),r.a.createElement("select",{value:s,onChange:function(e){return p(Number(e.target.value))}},!E.a.isEmpty(_)&&E.a.map(_,(function(e){return r.a.createElement("option",{key:e,value:e},e)})))),r.a.createElement("div",null,r.a.createElement("p",null,"Select Instruments:"),r.a.createElement("select",{value:a,onChange:function(e){return l(e.target.value)}},!E.a.isEmpty(K)&&E.a.map(K,(function(e){return r.a.createElement("option",{key:e,value:e},e)})))),r.a.createElement("div",{onClick:function(){return y(!g)}},r.a.createElement("p",null,"Include back-predicted results"),g?r.a.createElement(m.a,{icon:d.a}):r.a.createElement(m.a,{icon:d.c,className:"unchecked"}))),B||!s?r.a.createElement("div",{className:"loader"},r.a.createElement(m.a,{icon:d.b,spin:!0,size:"3x"})):r.a.createElement(r.a.Fragment,null,E.a.isEmpty(R)?r.a.createElement("p",null,"Nothing to display - change a filter!"):r.a.createElement(r.a.Fragment,null,"absolute"===S&&r.a.createElement(h,{data:R}),"change"===S&&r.a.createElement(z,{data:R}))))}var _=a(18),S=a(163);function K(){var e=new S.a({uri:"https://boiling-ridge-24261.herokuapp.com/v1/graphql"});return r.a.createElement(_.a,{client:e},r.a.createElement(D,null))}i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(K,null)),document.getElementById("root"))}},[[190,1,2]]]);
//# sourceMappingURL=main.7f62bf40.chunk.js.map